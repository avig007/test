<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>💌 Submit a Love Letter</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet" />

  <!-- Sound effect -->
  <audio id="clickSound" src="https://www.myinstants.com/media/sounds/anime-wow-sound-effect.mp3" preload="auto"></audio>

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-image: url('https://raw.githubusercontent.com/avig007/gf_grievance_portal/60ad5ae33b2c19ba353eecfe5b604ad019c78480/IMG_1129.JPG');
      background-size: cover;
      background-attachment: fixed;
      background-position: center;
      color: #fff;
      padding: 40px;
      max-width: 700px;
      margin: auto;
      backdrop-filter: blur(7px);
      animation: fadeIn 1.2s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h1 {
      font-family: 'Playfair Display', serif;
      font-size: 56px;
      color: #ff69b4;
      text-align: center;
      margin-bottom: 30px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    label {
      font-family: 'Playfair Display', serif;
      font-size: 20px;
      margin-top: 16px;
      display: block;
    }

    textarea, input[type="text"], input[type="file"], button {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      margin-bottom: 16px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      box-sizing: border-box;
      animation: slideUp 0.5s ease-in-out;
    }

    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    button {
      background-color: #ff1493;
      color: white;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
      transition: transform 0.3s ease, background-color 0.3s;
      font-family: 'Playfair Display', serif;
      animation: bounceIn 1s ease-in;
    }

    button:hover {
      background-color: #e60073;
      transform: scale(1.05);
    }

    @keyframes bounceIn {
      0% { transform: scale(0.8); opacity: 0; }
      60% { transform: scale(1.1); opacity: 1; }
      100% { transform: scale(1); }
    }

    .question {
      background: rgba(255, 255, 255, 0.1);
      padding: 14px;
      border-radius: 10px;
      margin-bottom: 16px;
    }

    .options label {
      font-weight: normal;
      font-size: 16px;
      display: block;
      margin-left: 20px;
      font-family: 'Poppins', sans-serif;
    }

    .custom-input {
      margin-left: 20px;
      margin-top: 8px;
      width: calc(100% - 20px);
    }

    input[type="checkbox"] {
      margin-right: 6px;
      vertical-align: middle;
    }

    .note {
      font-size: 12px;
      color: #fdd;
      margin-top: -10px;
    }
  </style>
</head>

<body>
  <h1>💌 Submit a Love Letter</h1>

  <form id="loveForm">

    <div class="question">
      <label for="loveLetterMessage">Your message to your MAN? Any wishes or a cute love letter??</label>
      <textarea id="loveLetterMessage" rows="4" placeholder="Type your love letter here..."></textarea>
    </div>

    <div class="question">
      <label>💄 What was the best moment you remember of us two together??</label>
      <div class="options">
        <label><input type="checkbox" name="bestMoment" value="Mumbai trip" />Mumbai short trip with unlimited cuddles and kisses.</label>
        <label><input type="checkbox" name="bestMoment" value="Thailand Jet ski" />Thailand Jet ski.</label>
        <label><input type="checkbox" name="bestMoment" value="Late night calls" />Late night endless calls with literal bakchodi.</label>
        <label><input type="checkbox" name="bestMoment" value="Goa trip" />Goa trip</label>
        <input class="custom-input" type="text" name="bestMomentCustom" placeholder="Others..." />
      </div>
    </div>

    <div class="question">
      <label>💫 In mood for....</label>
      <div class="options">
        <label><input type="checkbox" name="inMoodFor" value="💋 Hugs and cuddles" />💋 Hugs and cuddles for all night....❤️</label>
        <label><input type="checkbox" name="inMoodFor" value="🔥 Candlelight dinner" />🔥 Candlelight dinner and deep talks....🕯️</label>
        <label><input type="checkbox" name="inMoodFor" value="💦 Hardcore Sex" />💦 Hardcore Sex all night with you under my total control...</label>
        <label><input type="checkbox" name="inMoodFor" value="👅 Giving head" />👅 Giving me the head of my life...</label>
        <label><input type="checkbox" name="inMoodFor" value="🖤 Sitting on face" />🖤 You sitting on my face like a queen...</label>
        <input class="custom-input" type="text" name="inMoodForCustom" placeholder="Or write your own fantasy..." />
      </div>
    </div>

    <div class="question">
      <label for="safeWord">🖤 Your safe word (just in case 😉)?</label>
      <input type="text" id="safeWord" name="safeWord" placeholder="Enter something cute or spicy" />
    </div>

    <div class="question">
      <label>🧣 Pick your secret weapon:</label>
      <div class="options">
        <label><input type="checkbox" name="secretWeapon" value="Silk scarf" />Silk scarf</label>
        <label><input type="checkbox" name="secretWeapon" value="Whipped cream" />Whipped cream</label>
        <label><input type="checkbox" name="secretWeapon" value="Ice cube" />Ice cube</label>
        <label><input type="checkbox" name="secretWeapon" value="Feather" />Feather</label>
        <input class="custom-input" type="text" name="secretWeaponCustom" placeholder="Your naughty tool?" />
      </div>
    </div>

    <div class="question">
      <label for="uploadPhotos">Upload photos (max 15):</label>
      <input type="file" id="uploadPhotos" multiple accept="image/*">
      <div class="note">You can upload multiple photos.</div>
    </div>

    <div class="question">
      <label for="loveLetterFile">Attach a love letter file:</label>
      <input type="file" id="loveLetterFile" accept=".txt,.doc,.docx,.pdf">
    </div>

    <button type="button" onclick="submitForm()">Send Your Love 💕</button>
  </form>

  <script>
    async function submitForm() {
      document.getElementById("clickSound").play(); // Play sound

      const loveLetterMessage = document.getElementById('loveLetterMessage').value.trim();
      const safeWord = document.getElementById('safeWord').value.trim();

      function getCheckedValues(name) {
        return Array.from(document.querySelectorAll(`input[name="${name}"]:checked`)).map(el => el.value);
      }

      const bestMoment = getCheckedValues('bestMoment');
      const inMoodFor = getCheckedValues('inMoodFor');
      const secretWeapon = getCheckedValues('secretWeapon');

      const bestMomentCustom = document.querySelector('input[name="bestMomentCustom"]').value.trim();
      const inMoodForCustom = document.querySelector('input[name="inMoodForCustom"]').value.trim();
      const secretWeaponCustom = document.querySelector('input[name="secretWeaponCustom"]').value.trim();

      if (bestMomentCustom) bestMoment.push(bestMomentCustom);
      if (inMoodForCustom) inMoodFor.push(inMoodForCustom);
      if (secretWeaponCustom) secretWeapon.push(secretWeaponCustom);

      const uploadPhotosInput = document.getElementById('uploadPhotos');
      const loveLetterFileInput = document.getElementById('loveLetterFile');

      let photoNames = [];
      if (uploadPhotosInput.files.length > 0) {
        for (const file of uploadPhotosInput.files) {
          const base64 = await fileToBase64(file);
          const name = await new Promise(resolve =>
            google.script.run.withSuccessHandler(resolve).uploadFileToDrive(base64, file.name, file.type)
          );
          photoNames.push(name);
        }
      }

      let loveLetterFileName = "No file";
      if (loveLetterFileInput.files.length > 0) {
        const file = loveLetterFileInput.files[0];
        const base64 = await fileToBase64(file);
        loveLetterFileName = await new Promise(resolve =>
          google.script.run.withSuccessHandler(resolve).uploadFileToDrive(base64, file.name, file.type)
        );
      }

      const answers = {
        loveLetterMessage,
        bestMoment,
        inMoodFor,
        safeWord,
        secretWeapon
      };

      google.script.run
        .withSuccessHandler(url => {
          alert('Your love letter has been sent! File saved at:\n' + url);
          document.getElementById('loveForm').reset();
        })
        .saveAnswersToSheetAndDrive(answers, loveLetterFileName);
    }

    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = e => resolve(e.target.result);
        reader.onerror = e => reject(e);
        reader.readAsDataURL(file);
      });
    }
  </script>
</body>
</html>
