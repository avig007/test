

<!DOCTYPE html>
<html>
<head>
  <title>Submit Love Letter</title>
</head>
<body>
  <h1>Submit Your Love Letter</h1>
  <input id="username" placeholder="Your Name"><br><br>
  <textarea id="loveLetterMessage" placeholder="Your Message"></textarea><br><br>

  <label>Best Moment:</label><br>
  <input type="checkbox" name="bestMoment" value="First Kiss"> First Kiss<br>
  <input type="checkbox" name="bestMoment" value="Proposal"> Proposal<br><br>

  <label>In Mood For:</label><br>
  <input type="checkbox" name="inMoodFor" value="Dinner"> Dinner<br>
  <input type="checkbox" name="inMoodFor" value="Movie"> Movie<br><br>

  <input id="safeWord" placeholder="Safe Word"><br><br>

  <label>Secret Weapon:</label><br>
  <input type="checkbox" name="secretWeapon" value="Poetry"> Poetry<br>
  <input type="checkbox" name="secretWeapon" value="Music"> Music<br><br>

  <label>Upload Memory:</label>
  <input type="file" id="fileUpload"><br><br>

  <button onclick="submitLoveLetter()">Submit ðŸ’Œ</button>

  <script>
    async function submitLoveLetter() {
      const username = document.getElementById("username").value;
      const message = document.getElementById("loveLetterMessage").value;
      const bestMoment = [...document.querySelectorAll('input[name="bestMoment"]:checked')].map(el => el.value);
      const inMoodFor = [...document.querySelectorAll('input[name="inMoodFor"]:checked')].map(el => el.value);
      const safeWord = document.getElementById("safeWord").value;
      const secretWeapon = [...document.querySelectorAll('input[name="secretWeapon"]:checked')].map(el => el.value);
      const fileInput = document.getElementById("fileUpload");

      let base64File = null, fileName = null, mimeType = null;
      if (fileInput.files.length > 0) {
        const file = fileInput.files[0];
        fileName = file.name;
        mimeType = file.type;
        base64File = await toBase64(file);
      }

      const payload = {
        username,
        loveLetterMessage: message,
        bestMoment,
        inMoodFor,
        safeWord,
        secretWeapon,
        fileName,
        mimeType,
        base64Data: base64File
      };

      const response = await fetch("https://script.google.com/macros/s/AKfycbyDt8pWQys0LNfYgck_b_StTzdaJKNsaHzYcPIlLsCpJbaKjl7BQQppJecomwqpQSkrWg/exec", {
        method: "POST",
        body: JSON.stringify({ type: "loveletter", data: payload }),
        headers: { "Content-Type": "application/json" }
      });

      const result = await response.json();
      alert(result.message);
    }

    function toBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }
  </script>
</body>
</html>
